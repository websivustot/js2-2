<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Lesson2</title>
</head>

<body>
    <input type="text">
    <script>
        function IsLoginFree(selector) {
            _this = this;
            if (typeof selector === 'string') this.input = document.querySelector(selector);
            else this.input = selector;
            this.input.setAttribute("placeholder", "Выберите логин");

            this.input.onkeydown = function () {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'logins.json', true);
                xhr.send();
                xhr.onreadystatechange = function () {
                    if (xhr.readyState != 4) return;
                    if (xhr.status != 200) {
                        alert(xhr.status + ': ' + xhr.statusText);
                    } else {
                        var logins = JSON.parse(xhr.responseText);
                        _this.checkLogin = _this.checkNames(logins);
                        _this.showMessage(_this.checkLogin);
                    }
                }
            }
        }

        IsLoginFree.prototype.checkNames = function (logins) {
            var answer = false;
            for (var key in logins) {
                console.log("input=",this.input.value,logins[key]);
                if (logins[key] == this.input.value) {
                    answer = true;
                }
                
            }
            return answer;
        }

        IsLoginFree.prototype.showMessage = function (checkLogin) {
            if (document.querySelector('span') == null) {
                br = document.createElement('br');
                this.input.parentNode.appendChild(br);
                message = document.createElement('span');
                this.input.parentNode.appendChild(message);
            }
            if (this.checkLogin) {
                text = "Такое имя занято!";
                message.style.color = "red";
            } else {
                text = "Логин свободен";
                message.style.color = "green";
            }
            message.innerText = text;
        }
        var x = new IsLoginFree('input');
    </script>
</body>

</html>